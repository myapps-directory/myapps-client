<CPackWiXPatch>
  <CPackWiXFragment Id="#PRODUCT">
  
    <Property Id="ALLUSERS">0</Property>
    <Property Id="MSIRESTARTMANAGERCONTROL">Disable</Property>
    <Property Id='NOTEPAD'>Notepad.exe</Property>

    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="LocalAppDataFolder">
        <!-- Create a folder inside program files with Company Name-->
          <Directory Id="INSTALLFOLDER" Name="OLA">
          </Directory>
      </Directory>
      <!--Create application folder in Program Menu-->
    </Directory>

    <UI>
        <Publish Dialog="ExitDialog" 
            Control="Finish" 
            Event="DoAction" 
            Value="LaunchReadMe">WIXUI_EXITDIALOGOPTIONALCHECKBOX = 1 and NOT Installed</Publish>
    </UI>

    <Property Id="WIXUI_EXITDIALOGOPTIONALCHECKBOXTEXT" Value="Show Readme.txt" />
    <CustomAction Id='LaunchReadMe' Property='NOTEPAD' ExeCommand='[ARPINSTALLLOCATION]readme.txt' Return='asyncNoWait' />

 
    <InstallExecuteSequence>
      <Custom Action='ServiceInstall' After='InstallFiles'>(NOT Installed) AND (NOT REMOVE)</Custom>
      <Custom Action='ServiceUninstall' After='ProcessComponents'>Installed</Custom>

       <!-- <ScheduleReboot After='InstallFinalize' /> -->
    </InstallExecuteSequence>

    <CustomAction Id="ServiceInstall" Directory='INSTALL_ROOT'
              Execute="commit" Impersonate="no" Return="ignore"
              ExeCommand='[CM_DP_bin]memgrow_service.exe --service-install'/>

    <CustomAction Id="ServiceUninstall" Directory='INSTALL_ROOT'
              Execute="deferred" Impersonate="no" Return="asyncWait"
              ExeCommand='[CM_DP_bin]memgrow_service.exe --service-uninstall'/>

    <!-- https://www.firegiant.com/wix/tutorial/events-and-actions/extra-actions/
    <InstallExecuteSequence>
      <Custom Action='LaunchReadMe' After='InstallFinalize'>NOT Installed</Custom>
       <ScheduleReboot After='InstallFinalize' />
    </InstallExecuteSequence>
    -->
  </CPackWiXFragment>
</CPackWiXPatch>
